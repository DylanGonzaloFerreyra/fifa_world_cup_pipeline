{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-11-10T06:03:33.745363Z", "invocation_id": "189578d5-49b6-4b3f-a3d2-0404b461add6", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T06:03:33.576009Z", "completed_at": "2025-11-10T06:03:33.597977Z"}, {"name": "execute", "started_at": "2025-11-10T06:03:33.598929Z", "completed_at": "2025-11-10T06:03:33.725494Z"}], "thread_id": "Thread-1", "execution_time": 0.1517934799194336, "adapter_response": {"_message": "SELECT 22", "code": "SELECT", "rows_affected": 22}, "message": "SELECT 22", "failures": null, "unique_id": "model.transformation.fifa_world_cup_finals", "compiled": true, "compiled_code": "\n\nwith raw as (\n    SELECT * FROM \"fifa_dw_project\".\"staging\".\"fifa_raw_finals\"\n)\nSELECT\n    \"Year\"::int as year,\n    \"Winners\" as winners,\n    SPLIT_PART(SPLIT_PART(\"Score\", ' ', 1), '\u2013', 1) as winner_goals,\n    SPLIT_PART(SPLIT_PART(REGEXP_REPLACE(\"Score\", '\\[.*\\]', ''), ' ', 1), '\u2013', 2) as runner_up_goals,\n    \n    -- L\u00f3gica alternativa con limpieza de la cadena de penales\n    CASE WHEN \"Score\" LIKE '%pen.%' THEN\n        SPLIT_PART(\n            REGEXP_REPLACE(\n                REGEXP_SUBSTR(\"Score\", '\\(\\d+\u2013\\d+ pen\\.\\)'), -- Aisla solo la parte de los penales\n                '[^0-9\u2013]', -- Elimina todo excepto n\u00fameros y el guion\n                '', \n                'g'\n            ), \n        '\u2013', 1)\n    END as penalties_winner,\n\n    CASE WHEN \"Score\" LIKE '%pen.%' THEN\n        SPLIT_PART(\n            REGEXP_REPLACE(\n                REGEXP_SUBSTR(\"Score\", '\\(\\d+\u2013\\d+ pen\\.\\)'), -- Aisla solo la parte de los penales\n                '[^0-9\u2013]', \n                '', \n                'g'\n            ), \n        '\u2013', 2)\n    END as penalties_runner_up,\n    \n    \"Runners-up\" as runners_up,\n    \"Venue\" as venue,\n    SPLIT_PART(\"Location\", ',', 1) as host_city,\n    SPLIT_PART(\"Location\", ',', 2) as host_country,\n    \"Attendance\"::int as attendance\nFROM raw WHERE raw.\"Winners\" IS NOT NULL", "relation_name": "\"fifa_dw_project\".\"analytics\".\"fifa_world_cup_finals\""}], "elapsed_time": 0.5115599632263184, "args": {"which": "run", "print": true, "full_refresh": true, "defer": false, "warn_error_options": {"include": [], "exclude": []}, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format_file": "debug", "show_resource_report": false, "require_resource_names_without_spaces": false, "static_parser": true, "send_anonymous_usage_stats": true, "log_path": "/opt/airflow/transformation/logs", "indirect_selection": "eager", "log_level": "info", "exclude": [], "enable_legacy_logger": false, "populate_cache": true, "quiet": false, "partial_parse": true, "log_level_file": "debug", "write_json": true, "profiles_dir": ".", "empty": false, "favor_state": false, "project_dir": "/opt/airflow/transformation", "source_freshness_run_project_hooks": false, "partial_parse_file_diff": true, "use_colors": true, "invocation_command": "dbt run --profiles-dir . --select fifa_world_cup_finals --full-refresh", "strict_mode": false, "version_check": true, "vars": {}, "printer_width": 80, "cache_selected_only": false, "introspect": true, "log_file_max_bytes": 10485760, "use_colors_file": true, "select": ["fifa_world_cup_finals"], "log_format": "default", "macro_debugging": false}}